<!DOCTYPE HTML>
<html>
  <head>
    <!--
<link href='http://fonts.googleapis.com/css?family=Neuton:300,700' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Droid+Serif:400,400italic' rel='stylesheet' type='text/css'>

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Tauri' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Muli' rel='stylesheet' type='text/css'>

<link href='http://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>

<link href='http://fonts.googleapis.com/css?family=Libre+Baskerville:400,700,400italic' rel='stylesheet' type='text/css'>


<link href='http://fonts.googleapis.com/css?family=Rokkitt:400,700' rel='stylesheet' type='text/css'>


<script src="//use.typekit.net/mvn1usv.js"></script>
<script>try{Typekit.load();}catch(e){}</script>

<script src="//use.typekit.net/mvn1usv.js"></script>
<script>try{Typekit.load();}catch(e){}</script>

-->

<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/feed/" />

<meta charset="utf-8">
 
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="keywords" content="Animation">
<meta name="author" content="Ted Hagos">
<meta name="description" content="When things inside the HTML5 Canvas bumps into each other" />

<meta name="google-site-verification" content="Dg--5pO3MqOZk7aJ4jMia-MpnfcGdJaGIkYBJIDSkWU" />

<title>
  
    Handling Collissions | theLogBox
  
</title>


    <link rel="stylesheet" type="text/css" href="/css/style_tutorial.css" />  
  </head>
  <body>

    <mast><a href="/">theLogBox.com</a>/html5</mast>

    <article itemscope itemtype="http://schema.org/Article" >    
      <headline>Handling Collissions</headline>
      <author>
        By <a href='https://plus.google.com/+TedHagos?rel=author'>Ted Hagos</a>
      </author>
      <dateCreated>
        written on March 23, 2013
        
      </dateCreated>

      <articleBody itempprop="articleBody">
        <p>Collission detection inside the canvas needs to be managed by you. Everytime you update the location of any object, you will need to provide the programming logic to check if any of your canvas objects is colliding with any other object or if it is colliding with the bounds of the canvas.</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>	
	<span class="nt">&lt;script&gt;</span>
	
  <span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">cx</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">box</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  
  <span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    
    <span class="nx">c</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;mycanvas&#39;</span><span class="p">);</span>
    <span class="nx">cx</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s1">&#39;2d&#39;</span><span class="p">);</span>
    <span class="nx">box</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Box</span><span class="p">();</span>
    
    <span class="nx">update</span><span class="p">();</span>
    
    <span class="kd">function</span> <span class="nx">update</span><span class="p">()</span> <span class="p">{</span>
            
      <span class="k">if</span><span class="p">((</span><span class="nx">box</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">box</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nx">c</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">cx</span><span class="p">.</span><span class="nx">clearRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
        <span class="nx">cx</span><span class="p">.</span><span class="nx">fillRect</span><span class="p">(</span><span class="nx">box</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">box</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">box</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">box</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
        <span class="nx">box</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">box</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">box</span><span class="p">.</span><span class="nx">speed</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">update</span><span class="p">,</span><span class="mi">50</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">Box</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">speed</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
  <span class="p">}</span>
	<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body&gt;</span>
  <span class="nt">&lt;canvas</span> <span class="na">id=</span><span class="s">&#39;mycanvas&#39;</span> <span class="na">height=</span><span class="s">&#39;400&#39;</span> <span class="na">width=</span><span class="s">&#39;500&#39;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/canvas&gt;</span>
<span class="nt">&lt;/body&gt;</span>

<span class="nt">&lt;/html&gt;</span></code></pre></div>

<p>This code sample basically moves the box object along the <em>y-axis</em>. Notice that prior to the <em>clear-update-redraw</em> operation, the bounds of the box is checked against the height of the canvas. If the box’s current <em>y-location</em> plus the height of the box is less than the value of the canvas’ height, the animation continues, if not, then no action is taken. This gives the appearance that the box stops at the bottom of the canvas.</p>

<h2 id="refactor">Refactor</h2>

<p>You could make the codes a bit more modular if you move the programming logic of the collission detection away from the drawing logic.</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>	
	<span class="nt">&lt;script&gt;</span>
	
  <span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">cx</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">box</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  
  <span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    
    <span class="nx">c</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;mycanvas&#39;</span><span class="p">);</span>
    <span class="nx">cx</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s1">&#39;2d&#39;</span><span class="p">);</span>
    <span class="nx">box</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Box</span><span class="p">();</span>
    
    <span class="nx">update</span><span class="p">();</span>
    
    <span class="kd">function</span> <span class="nx">update</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">isInCollission</span><span class="p">(</span><span class="nx">box</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">cx</span><span class="p">.</span><span class="nx">clearRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nx">c</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">c</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
        <span class="nx">cx</span><span class="p">.</span><span class="nx">fillRect</span><span class="p">(</span><span class="nx">box</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">box</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="nx">box</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">box</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
        <span class="nx">box</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="nx">box</span><span class="p">.</span><span class="nx">speed</span><span class="p">;</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">update</span><span class="p">,</span><span class="mi">50</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">isInCollission</span><span class="p">(</span><span class="nx">box</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">((</span><span class="nx">box</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">box</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nx">c</span><span class="p">.</span><span class="nx">width</span> <span class="o">&amp;</span>  
       <span class="p">(</span><span class="nx">box</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">box</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nx">c</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
       <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">Box</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">speed</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
  <span class="p">}</span>
	<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body&gt;</span>
  <span class="nt">&lt;canvas</span> <span class="na">id=</span><span class="s">&#39;mycanvas&#39;</span> <span class="na">height=</span><span class="s">&#39;400&#39;</span> <span class="na">width=</span><span class="s">&#39;500&#39;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/canvas&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></div>

<p>The function <strong>isInCollission()</strong> takes a parameter (a box parameter) and checks if either the bottom or the right side of the box is in contact with either the right boundary or the floor of the canvas — of course you make it more robust by including codes that checks for collission on ceiling or the left side of the canvas, but that is left to you as an exercise.</p>

 
      </articleBody>      
    </article>
    
    
    <toc>
      <div align="center">
      <h2>HTML5 Tutorials</h2>
      </div> 

    <div class="toc">
      <ul>
      <li><a href="/working-with-html5">Introduction</a></li>
      <li><a href="/html5-what-you-will-need">What you need for Dev</a></li>
      <li><a href="#">Markup Basics</a></li>
      <li><a href="/html5-canvas-basics">Canvas - Basics</a></li>
      <li><a href="/html5-moving-straight-line">Canvas -  Moving Objects</a></li>
      <li><a href="/html5-canvas-acceleration">Canvas - Accelerating Objects</a></li>
      <li><a href="/html5-canvas-handling-clicks">Canvas - Event handling</a></li>
      <li><a href="/html5-canvas-objects-with-different-speeds">Canvas - Moving at Different speeds</a></li>
      <li><a href="/html5-canvas-managing-complexity">Canvas - Managing Complexity</a></li>
      <li><a href="/html5-database-programming">Database Programming with WebSQL</a></li>
    </ul>
    </div>  

    </toc>    
    
    <p/>
    <button id="comment">Display Comments</button> 
    <script>
      window.onload = function() {

        document.getElementById('disqus_thread').style.display="none";

        document.getElementById('comment').onclick = function() {
          document.getElementById('disqus_thread').style.display="block";
          document.getElementById('comment').style.display="none";
        }
      }
    </script>

 <!-- DISQUS javascript -->
    <div id="disqus_thread"></div>
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'logbox'; // required: replace example with your forum shortname

          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>  
      
<!-- END Disqus-->
    <footer>
Copyright &copy; theLogBox.com. All rights reserved <br/>



<!-- Begin MailChimp Signup Form -->
<div id="mc_embed_signup">
<form action="//thelogbox.us5.list-manage.com/subscribe/post?u=ccf5609c10396fa44241f5400&amp;id=b8557d8e8a" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
	
	<label for="mce-EMAIL">You can subscribe to the newsletter by providing your email address here &rarr; </label>
	<input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
	<input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
	
	<div id="mce-responses" class="clear">
		<div class="response" id="mce-error-response" style="display:none"></div>
		<div class="response" id="mce-success-response" style="display:none"></div>
	</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    
    <div style="position: absolute; left: -5000px; display:none">
    	<input type="text" name="b_ccf5609c10396fa44241f5400_b8557d8e8a" tabindex="-1" value="">
    </div>
</div>

</form>
</div>

<!--End mc_embed_signup-->

</footer>
    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-38198657-1']);
  _gaq.push(['_setDomainName', 'thelogbox.com']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
    <!-- Start of StatCounter Code for Default Guide -->
	
  <script type="text/javascript">
  var sc_project=7827488; 
  var sc_invisible=1; 
  var sc_security="069357c9"; 
  </script>
  <script type="text/javascript"
      src="http://www.statcounter.com/counter/counter.js"></script>
  <noscript><div class="statcounter"><a title="customizable
      counter" href="http://statcounter.com/free-hit-counter/"
      target="_blank"><img class="statcounter"
      src="http://c.statcounter.com/7827488/0/069357c9/1/"
      alt="customizable counter"></a></div></noscript>
  <!-- End of StatCounter Code for Default Guide -->
  </body>
</html>


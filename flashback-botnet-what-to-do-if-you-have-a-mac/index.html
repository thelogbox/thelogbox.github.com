<!DOCTYPE HTML>
<html lang="en">
  <head>
		<style>
* {
  font-size: .98em;
  background: #FFFFFF;
  color: #414141;
}

ol, li, p {
  font-family: 'Open Sans';
  line-height: 1.5em;
}

#shock-left {
  font-family: 'Rokkitt';
  font-size: 250%;
  font-weight:normal;
  letter-spacing: -1.5px;
  color: #61768a;
  text-align: center;
  width: 100%;
  float:left;
  height: 5em;
  padding-top:10px;
  margin-top:50px;
}

  #shock-left a:link, #shock-left a:visited {
    color: #61768a;
    border-bottom: 2px dotted #61768a;
  }
  #shock-left a:hover {
    color: #61768a;
    border-bottom: 2px solid #61768a;;
  }

  #shock-right {
    padding-top:70px;
    font-family: 'Rokkitt';
    font-size: 450%;
    font-weight:normal;
    letter-spacing: -1.5px;
    line-height: -.7em;
    color: #61768a;
    text-align:center;
  }

/*
#shock-right {
  font-size: 350%;
  font-weight:bold;
  letter-spacing: -1.5px;
  color: #004646;
  float: right;
  height: 250px;
  width:40%;
  padding-top:30px;
  text-align: right;
  margin-right:50px;
}
*/
  
body {
  font-family: 'Open Sans';
  width: 800px;
  margin-left: auto;
  margin-right: auto;
}

header {
  height:4.5em;
  margin-top:10px;
  border-bottom:0px dotted #009494;
}

#navleft, #navright {
  font-family: 'Rokkitt';
  font-size: 22px;
}

#navleft a:link, #navleft a:visited {
  color: #CACACA;
  float:left;
  /*font-size:250%;*/
  font-weight:normal;
  margin-left:0px;  
}
  #navleft a:hover {
    color: #61768a;
    border-bottom: 0px solid #61768a;
  }

#navright a:link, #navright a:visited {
  padding-left:5px;
  padding-right:5px;
  float:right;
  /*font-size: 110%; */
  color: #CACACA;
  text-decoration:none;
}

  #navright a:hover {
    color: #61768a;
    border-bottom:1px solid #DEDEDE;
  }

#spacer {clear:both;margin-bottom:50px;}

#inner {

}
footer {
  font-size: 120%;
  text-align: center;
  clear:both;
  display:block;
  font-size: 90%;
  margin-top: 100px;
  margin-bottom: 30px;
}

/* Headings and Titles */

#trainingtitle {
  font-family: 'Rokkitt';
  color: #61768a;
  font-size: 350%;
  font-weight: normal;
  text-align: left;
  padding-top: 20px;
}

#articletitle {
  font-family: 'Rokkitt';
  font-size:280%; 
  font-weight: normal;
  color: #61768a;
  margin-top:20px;
  text-align: center;
}

h1, h2, h3, h4, h5 {
  font-family: 'Rokkitt';
  color: #61768a; 
  font-weight:normal;
}
h1 {font-size: 170%;}
h2 {font-size: 140%;}
h3 {font-size: 120%;}
h4 {font-size: 110%;}

/* LINKS */

a:link, a:visited {
  color: #004a94;
  text-decoration: none;
}

a:hover {
  color: #0072e3;
  border-bottom: 1px solid #0072e3;
}



/* OTHER BLOCKS */

#minitoc {

  color: #4E4E4E;
  width: 35%;
  float: right;
  margin-left:30px;
  
  margin-bottom:30px;
  padding-top: 10px;
  padding-bottom:20px;
  border: 3px solid #E8E8E8;  
  padding-left:10px;
  padding-right:20px;
    
  line-height:20px;   
}

#contentmeta {
  color: gray;
  text-align: center;
  margin-bottom:40px;
}

#sidebarright {
  float: right;
  width:300px;
  /* background: #FFFFC8; */
  border: 1px solid #FFA500;
  padding: 20px;
  margin-left: 20px;
}

/* MAIL CHIMP CSS*/

#mce-EMAIL {
  font-family: 'Rokkitt';
  font-size: 25px;
  color: #000000;
  width: 450px;
  background: #FFFFF6;
  border:3px solid #000000;
  margin-bottom: 10px;
  padding-top: 10px;
  padding-bottom: 10px;
  padding-left: 20px;
  height: 15px;
  text-align:center;
}

#mc-embedded-subscribe {
  background: #000000;
  color: #FFFFFF;
  padding: 10px 15px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  cursor: pointer;
  text-align: center;
  width: 200px;
  border: 0px;
  font-family: 'Rokkitt';
  font-size: 25px;
}

#mc-embedded-subscribe:hover {
  background: red;
}  

#mc_embed_signup {
  border: 0px solid #618a8a ;
  margin-top: 50px;
  padding-top: 0px;
  padding-bottom: 20px;
  padding-left: 0px;
  text-align: center;
}

/* MAIL CHIMP CSS*/

/* PRE AND CODE AREA */


pre {

  margin-top: 15px;
  margin-bottom:15px;

  padding: 10px 5px 10px 15px;
  font-size: 75%;
  font-family: 'Source Code Pro';
  border: 2px solid #cacaca;
  background: white;

  /*
  border: 1px solid #DEDEDE;
  background: #F5F5F5;
  color: #000;

  -moz-border-radius: 10px;
  -webkit-border-radius: 10px;  
  border-radius: 10px;
  */

}


pre code, .keyword, .directive, .type, 
          .string, .function, .class, 
          .reserved, .content, .comment, 
          .predefined-type, .preprocessor, .tag,
          .attribute-name, .include, .predefined-constant, 
          .local-variable, .key, .class, .instance-variable,
          .symbol, .constant, .inline, .line-numbers,
          .integer, .char, .float {

      font-family: 'Source Code Pro';

}

/* definition of styles for code highlighting */

.keyword, .key, .directive, .type, .reserved, .predefined-type, .tag, .class {
  color: #6e6eFF;
}

.predefined-constant {
  color: gray;
}

.line-numbers {

  font-size: 70%;
  padding-right: 10px;
  color: #8E8E8E;
  font-family: 'Source Code Pro', Courier, "Courier New", monospace;
}

.include, .preprocessor, .attribute-name {
  color: #CD7300;
}

.string {
  color: #6C0000;
}

.comment {
  color: : gray;
}

.function, .class  {
  color: #2828A8;
}

.local-variable {
  color: blue;
}





</style>
		<meta charset="utf-8">
<title>FlashBack botnet, What to do if you are infected: theLogBox.com</title>

<link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Rokkitt' rel='stylesheet' type='text/css'>
<!--
<link rel="stylesheet" type="text/css" href="/style.css" media="screen">
-->

<meta name="google-site-verification" content="h3sz9mbRignTr-OFf8zOhJa_-2HaneH4frxtac50oFU" />

<meta name="google-site-verification" content="_fzAU-gezjC_Vaxgr8F_DsNKqRcVvyPztj9i8CRGLbA" />

<meta name="google-site-verification" content="Dg--5pO3MqOZk7aJ4jMia-MpnfcGdJaGIkYBJIDSkWU" />


		<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-38198657-1']);
  _gaq.push(['_setDomainName', 'thelogbox.com']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>	
  </head>
  <body>

    <div id="main" itemscope itemtype="http://schema.org/Article">

	  <header>
      
<div id='navleft'>
<a href='/'>[theLogBox]</a>
</div>

<div id='navright'>
  <a href='/courses/'>courses</a> &nbsp;&nbsp;
  <a href='/blog/'>blog</a> &nbsp;&nbsp;
  <a href='/tutorials/'>tutorials</a>
</div>
    </header>

	  <div id="articletitle" itemprop="headline">FlashBack botnet, What to do if you are infected</div>  
    <div id='contentmeta'>
by: 

<a href="https://plus.google.com/u/0/100317694679641558339?rel=author">
  Ted Hagos
</a> on 

<span itemprop="dateCreated"> 9.April.2012 </span>
</div>  

	  <div itemprop="articleBody">
      <p>600,000 Macs were infected by FlashBack botnet, the data is from <a href="http://www.cbsnews.com/8301-501465_162-57409904-501465/over-600000-macs-infected-with-flashback-botnet-patch-released/" title="CBS News">CBS News</a>. Intel-based Macs are the ones prone to infection (Tiger, Leopard, Snow Leopard, Lion).</p>
<p>There is no obvious way to tell if a machine is infected. A point-and-click solution is not available at the time of this writing.</p>
<p><a href="http://www.f-secure.com/v-descs/trojan-downloader_osx_flashback_i.shtml">F-secure</a> published a detailed <strong>detection</strong> and <strong>removal</strong> process of the FlashBack botnet. This process involves working on the console.</p>
<p><strong>First test</strong></p>
<pre><code>defaults read /Applications/Safari.app/Contents/Info LSEnvironment</code></pre>
<p>You are looking for a response like this;</p>
<blockquote>
<p>The domain/default pair of (/Applications/Safari.app/Contents/Info, LSEnvironment) does not exist --- <cite><a href="http://www.f-secure.com/v-descs/trojan-downloader_osx_flashback_i.shtml">F-secure website</a></cite></p>
</blockquote>
<p>So far, so good. If you got a result that is different that the one quoted above, at this point, chances are you already got the FlashBack botnet.</p>
<p><strong>Second test</strong></p>
<pre><code>defaults read ~/.MacOSX/environment DYLD_INSERT_LIBRARIES </code></pre>
<p>This time, you are looking for a response something like this</p>
<blockquote>
<p>The domain/default pair of (/Users/joe/.MacOSX/environment, DYLD_INSERT_LIBRARIES) does not exist --- <cite><a href="http://www.f-secure.com/v-descs/trojan-downloader_osx_flashback_i.shtml">F-Secure website</a></cite></p>
</blockquote>
<p>If you got the desired responses after running the two terminal commands above, you are (still) on the clear. You are not infected (yet) by the FlashBack botnet.</p>
<p>If the machine is infected, follow the removal instructions on the <a href="http://www.f-secure.com/v-descs/trojan-downloader_osx_flashback_i.shtml">F-Secure website</a>. Be warned though, the manual steps necessary to remove FlashBack botnet is not a trivial feat. Unless you are very very comfortable working on the command line and have prior experience navigating UNIX directories, you may want to either a) Find a more automated way to remove FlashBack, <a href="http://www.sophos.com/en-us/products/free-tools/sophos-antivirus-for-mac-home-edition.aspx">Sophos</a> and <a href="http://www.clamavx.com">ClamavX</a> may have some solutions for you; b) Find somebody, a friend or your IT guys at the office to help you out.</p>
<h2 id="is-there-an-easier-more-gui-way-of-doing-this">Is there an easier (more GUI way) of doing this?</h2>
<p>I don't know of any other way to detect the FlashBack botnet, as of time of writing. AS for the removal, the less technically-interested may want to check out <a href="http://www.sophos.com/en-us/products/free-tools/sophos-antivirus-for-mac-home-edition.aspx">Sophos</a> or <a href="http://www.clamavx.com">ClamavX</a> for the removal process.</p>
<h2 id="what-to-do-next">What to do next</h2>
<p>Patch up your Java installation. The FlashBack botnet actually attacks the vulnerability of the Java installed on your system, more specifically, it attacks the Java instance that is running o the browser.</p>
<p>If you are a Snow Leopard user, use the <a href="http://support.apple.com/kb/DL1516">Java for Mac OSX 10.6 Update 7</a>. If you are an OSX Lion user, use the <a href="http://support.apple.com/kb/DL1515">Java for OSX Lion 2012-002</a>. By the time I finish writing this, chances are you should be able to pull these updates automatically from the <em>Software Update</em> menu of OSX (Just click the little Apple logo at left-most-uuper-hand corner of your screen).</p>
<p>For now, to be a bit paranoid about this drive-by attack, you can disable Java in the browser. Don't worry, it will not uninstall Java, you should be able to run applications that require the Java Run Time still (like GotoMeeting). If you disable Java on the browser, it will effectively block FlashBack's drive-by attack.</p>
<h3 id="how-to-disable-java-on-the-browser">How to disable Java on the browser</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Chrome -</strong>Open Chrome, the type <em>chrome://plugins</em> on the URL box. Find the Java entry then disable it.</li>
<li>
<strong>Safari -</strong> Go to System Preferences, then Security. Uncheck the "Enable Java" entry.</li>
<li>
<strong>FireFox -</strong>Open FireFox, go to "Tools and Addons", select the Plugins tab, then disable Java</li>
</ol>
	  </div>
		<p/>



    <!-- Start of StatCounter Code for Default Guide -->
	
  <script type="text/javascript">
  var sc_project=7827488; 
  var sc_invisible=1; 
  var sc_security="069357c9"; 
  </script>
  <script type="text/javascript"
      src="http://www.statcounter.com/counter/counter.js"></script>
  <noscript><div class="statcounter"><a title="customizable
      counter" href="http://statcounter.com/free-hit-counter/"
      target="_blank"><img class="statcounter"
      src="http://c.statcounter.com/7827488/0/069357c9/1/"
      alt="customizable counter"></a></div></noscript>
  <!-- End of StatCounter Code for Default Guide -->
   
     <!-- DISQUS javascript -->
    <div id="disqus_thread"></div>
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'logbox'; // required: replace example with your forum shortname

          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>  
      
<!-- END Disqus-->
    <footer>
      &copy 2009-2013 theLogBox.com 

    </foter>

    </div>
  </body>

</html>

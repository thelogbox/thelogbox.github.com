<!DOCTYPE HTML>
<html lang="en">
  <head>
		<style>

* {
  font-size: 16px;
  background: #FFFFFF;
  color: #545454;
}

ul, ol, li, p {
  font-family: Arial ;
  line-height: 160%;
}

em {
  font-family: Georgia;
  color: #41505d;
}

strong {
  color: #000000;
}

img {
  display:block;
  margin-left:auto;
  margin-right:auto;
}

#shock-left {
  font-family: 'Rokkitt';
  font-weight:normal;
  letter-spacing: -1.5px;
  color: #61768a;
  text-align: center;
  width: 100%;
  float:left;
  height: 5em;
  padding-top:10px;
  margin-top:50px;
}

  #shock-left a:link, #shock-left a:visited {
    font-size: 45px;
    color: #61768a;
    border-bottom: 2px dotted #61768a;
  }
  #shock-left a:hover {
    color: #61768a;
    border-bottom: 2px solid #61768a;;
  }

  #shock-right {
    padding-top:70px;
    font-size: 85px;
    font-family: 'Rokkitt';
    font-weight:normal;
    letter-spacing: -1.5px;
    line-height: -.7em;
    color: #61768a;
    text-align:center;
  }

/*
#shock-right {
  font-size: 350%;
  font-weight:bold;
  letter-spacing: -1.5px;
  color: #004646;
  float: right;
  height: 250px;
  width:40%;
  padding-top:30px;
  text-align: right;
  margin-right:50px;
}
*/
  
body {
  font-family: Arial;
  width: 95%;
  margin-left: auto;
  margin-right: auto;
}

header {
  height:4.5em;
  margin-top:10px;
  border-bottom:0px dotted #009494;
}

#navleft, #navright {font-family: 'Rokkitt';}
#navleft a:link, #navleft a:visited {
  font-size: 22px;
  color: #CACACA;
  float:left;
  font-weight:normal;
  margin-left:0px;
}
  #navleft a:hover {
    color: #61768a;
    border-bottom: 0px solid #61768a;
  }

#navright a:link, #navright a:visited {
  font-size: 22px;
  padding-left:5px;
  padding-right:5px;
  float:right;
  color: #CACACA;
  text-decoration:none;
}

  #navright a:hover {
    color: #61768a;
    border-bottom:1px solid #DEDEDE;
  }

  .currentdir {
    font-family: 'Rokkitt';
    font-size: 22px;
    color: #000000;
    padding: 3px;
  }  

#spacer {clear:both;margin-bottom:50px;}

#inner {

}
footer {
  font-size: 120%;
  text-align: center;
  clear:both;
  display:block;
  font-size: 90%;
  margin-top: 100px;
  margin-bottom: 30px;
}

/* Headings and Titles */

#trainingtitle {
  font-family: 'Rokkitt';
  color: #61768a;
  font-size: 350%;
  font-weight: normal;
  text-align: left;
  padding-top: 20px;
}

#articletitle {
  font-family: 'Rokkitt';
  font-size:50px; 
  font-weight: normal;
  color: #61768a;
  margin-top:20px;
  text-align: center;
  letter-spacing: -1px;
}

h2, h3, h4, h5 {
  font-family: Arial;
  /*color: #61768a;*/
  color: #373737; 
  font-weight:normal;
}
h1 {
  font-family:'Tauri'; 
  font-size: 200%;
  letter-spacing: -1px;
}
h2 {font-size: 140%;}
  h2.section { border-bottom: 1px solid #CACACA;}
h3 {font-size: 120%;}
h4 {font-size: 110%;}

/* LINKS */

a:link, a:visited {
  /*color: #004a94;
  color: #0778e4;*/
  color: #b30000;
  text-decoration: none;
}

a:hover {
  color: #0072e3;
  border-bottom: 1px solid #0072e3;
}

hr {
  background: #61781a;
  color: #61781a;
  border: 3px solid #DEDEDE;
}

/* OTHER BLOCKS */

#minitoc {

  color: #4E4E4E;
  width: 35%;
  float: right;
  margin-left:30px;
  
  margin-bottom:30px;
  padding-top: 10px;
  padding-bottom:20px;
  border: 3px solid #E8E8E8;  
  padding-left:10px;
  padding-right:20px;
    
  line-height:20px;   
}

#contentmeta {
  font-family: 'Rokkitt';
  font-style: normal;
  color: gray;
  text-align: left;
  margin-bottom:40px;
  text-align: center;
}

#sidebarright {
  float: right;
  width:300px;
  /* background: #FFFFC8; */
  border: 1px solid #FFA500;
  padding: 20px;
  margin-left: 20px;
}

/* MAIL CHIMP CSS*/

#mce-EMAIL {
  font-size: 20px;
  letter-spacing: -1px;
  color: #000000;
  width: 60%;
  background: #FFFFF6;
  border:3px solid #000000;
  margin-bottom: 10px;
  padding-top: 10px;
  padding-bottom: 10px;
  padding-left: 20px;
  height: 15px;
  text-align:center;
}

#mc-embedded-subscribe {
  font-family: Arial;
  background: #000000;
  color: #FFFFFF;
  padding: 10px 15px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  cursor: pointer;
  text-align: center;
  width: 200px;
  border: 0px;
  font-size: 25px;
}

#mc-embedded-subscribe:hover {
  background: #0072e3;
}  

#mc_embed_signup {
  border: 0px solid #618a8a ;
  margin-top: 50px;
  padding-top: 0px;
  padding-bottom: 20px;
  padding-left: 0px;
  text-align: center;
}

/* MAIL CHIMP CSS*/

/* PRE AND CODE AREA */

#lst {  
  font-family: Georgia;
  font-size: 16px;
  text-align: center;
  margin: 15px;
  color: #000000;
}

pre {

  margin-top: 15px;
  margin-bottom:0px;

  padding: 10px 5px 10px 15px;
  
  /*font-size: .87em;*/
  font-size: 14px;
  font-family: 'Muli';
  background: #e8ebef;
  line-height: 130%;
  white-space: pre-wrap;
  
  /*
  border: 1px solid #DEDEDE;
  background: #FBFCF9; 
  */
  /*
  border: 1px solid #DEDEDE;
  background: #F5F5F5;
  color: #000;

  -moz-border-radius: 10px;
  -webkit-border-radius: 10px;  
  border-radius: 10px;
  */

}

pre.codeblock, .codeblock {
  
  font-family: 'Muli';
  font-size: 15px;
  color: #0000b3;
  background: #FFFFFF;
  padding:0px;
  margin: 0px;
}


pre code, .keyword, .directive, .type, 
          .string, .function, .class, 
          .reserved, .content, .comment, 
          .predefined-type, .preprocessor, .tag,
          .attribute-name, .include, .predefined-constant, 
          .local-variable, .key, .class, .instance-variable,
          .symbol, .constant, .inline, .line-numbers,
          .integer, .char, .float, .annotation, .namespace, 
          .content, .delimiter, .st, .sourceCode, .exception,
          .class-variable {

      font-family: 'Muli';
      /*font-size: 1em;*/
      font-size: 14px;
      background: #e8ebef; 
      color: #000000;
      line-height: 130%;

}

/* definition of styles for code highlighting */

/*
.keyword, .key, .directive, .type, .reserved, .predefined-type, .tag, .class {
  color: #6e6eFF;
}

.predefined-constant {
  color: gray;
}

.line-numbers {

  font-size: 70%;
  padding-right: 10px;
  color: #8E8E8E;
  font-family: 'Source Code Pro', Courier, "Courier New", monospace;
}

.include, .preprocessor, .attribute-name {
  color: #CD7300;
}

.string {
  color: #6C0000;
}

.comment {
  color: : gray;
}

.function, .class  {
  color: #2828A8;
}

.local-variable {
  color: blue;
}

*/
</style>
		<!--

<link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>

-->

<meta charset="utf-8">
<title>Notes on using Sinatra: theLogBox.com</title>

<link href='http://fonts.googleapis.com/css?family=Rokkitt' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Muli' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Tauri' rel='stylesheet' type='text/css'>

<!--
<link rel="stylesheet" type="text/css" href="/style.css" media="screen">
-->



		<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-38198657-1']);
  _gaq.push(['_setDomainName', 'thelogbox.com']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>	
  </head>
  <body>

    <div id="main" itemscope itemtype="http://schema.org/Article">

	  <header>
      
<div id='navleft'>
<a href='/'><span class="currentdir">theLogBox</a>
</div>

<div id='navright'>
  <a href='/courses/'>courses</a> &nbsp;&nbsp;
  <a href='/blog/'>blog</a> &nbsp;&nbsp;
  <a href='/tutorials/'>tutorials</a>
</div>
    </header>

	  <div id="articletitle" itemprop="headline">Notes on using Sinatra</div>  
    <div id='contentmeta'>
by: 

<a href="https://plus.google.com/u/0/100317694679641558339?rel=author">
  Ted Hagos
</a> on 

<span itemprop="dateCreated"> October 12, 2012 </span>
</div>  

	  <div itemprop="articleBody">
      <h1 id="up-and-running">1. Up and running</h1>
<p>


</p><ol style="list-style-type: decimal">
<li><p>Switch your ruby version</p></li>
<li>Install Sinatra <strong>$ sudo gem install sinatra</strong>. While you are it, install the <em>thin</em> package as well <strong>$ sudo gem install thin</strong>. Sinatra apps will run without thin</li>
<li><p>Make sure it's running, do the HelloWorld app</p></li>
</ol><pre><code class="language-ruby"><span class="comment"># helloworld.rb</span>

require <span class="string"><span class="delimiter">'</span><span class="content">rubygems</span><span class="delimiter">'</span></span> <span class="keyword">if</span> <span class="predefined-constant">RUBY_VERSION</span> &lt; <span class="string"><span class="delimiter">'</span><span class="content">1.9</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">sinatra</span><span class="delimiter">'</span></span>

get <span class="string"><span class="delimiter">'</span><span class="content">/</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
    <span class="string"><span class="delimiter">"</span><span class="content">Hello World</span><span class="delimiter">"</span></span>
<span class="keyword">end</span></code></pre>
<p>Run the web program using <strong>$ruby helloworld.rb</strong>. Open a web browser, if you can you see "Hello World" on http://localhost:4567, then Sinatra is up and running and you did not make a mess of the sample code</p>
<h1 id="put-some-structure-and-abstractions">2. Put some structure and abstractions</h1>
<p>It doesn't hurt to enclose the Sinatra routes in classes</p>
<pre><code class="language-ruby"><span class="comment"># helloworld.rb</span>

require <span class="string"><span class="delimiter">'</span><span class="content">rubygems</span><span class="delimiter">'</span></span> <span class="keyword">if</span> <span class="predefined-constant">RUBY_VERSION</span> &lt; <span class="string"><span class="delimiter">'</span><span class="content">1.9</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">sinatra</span><span class="delimiter">'</span></span>

<span class="keyword">class</span> <span class="class">First</span> &lt; <span class="constant">Sinatra</span>::<span class="constant">Base</span>
    get <span class="string"><span class="delimiter">'</span><span class="content">/</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
        <span class="string"><span class="delimiter">"</span><span class="content">Hello World</span><span class="delimiter">"</span></span>
    <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="constant">First</span>.run!</code></pre>
<p>run it again using <strong>$ ruby helloworld.rb</strong>, you may need to stop the currently running web server install on the terminal (CTRL-C)</p>
<h1 id="using-rackup-with-sinatra">3. Using RackUp with Sinatra</h1>
<h2 id="create-a-config.ru-file">3.1 Create a config.ru file</h2>
<p>

</p><pre><code class="language-ruby"><span class="comment"># config.ru</span>

require <span class="string"><span class="delimiter">'</span><span class="content">helloworld</span><span class="delimiter">'</span></span>

<span class="constant">First</span>.run!

<span class="comment"># First.new would have worked as well</span>
<span class="comment">#   creating a new instance of a Sinatra::Base class will also</span>
<span class="comment">#   run the web app</span></code></pre>
<p>You can put lots of things inside the config.ru, but we'll get to that later on</p>
<h1 id="routes">4. Routes</h1>
<p>

</p><pre><code class="language-ruby">require <span class="string"><span class="delimiter">'</span><span class="content">rubygems</span><span class="delimiter">'</span></span> <span class="keyword">if</span> <span class="predefined-constant">RUBY_VERSION</span> &lt; <span class="string"><span class="delimiter">'</span><span class="content">1.9</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">sinatra</span><span class="delimiter">'</span></span>

<span class="keyword">class</span> <span class="class">Route</span> &lt; <span class="constant">Sinatra</span>::<span class="constant">Base</span> 

    get <span class="string"><span class="delimiter">'</span><span class="content">/</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
        <span class="string"><span class="delimiter">"</span><span class="content">Landing page</span><span class="delimiter">"</span></span>
    <span class="keyword">end</span>

    get <span class="string"><span class="delimiter">'</span><span class="content">/client</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
        <span class="string"><span class="delimiter">"</span><span class="content">Client page</span><span class="delimiter">"</span></span>
    <span class="keyword">end</span>

    get <span class="string"><span class="delimiter">'</span><span class="content">/contact</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
        <span class="string"><span class="delimiter">"</span><span class="content">Contact page</span><span class="delimiter">"</span></span>
    <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
<p><strong>get</strong> is a method call, its not a method definition, this is one of the reasons why Sinatra is DSL (Domain Specific Language), its domain is RESTful web apps</p>
<h2 id="querystring-parameters">4.1 QueryString parameters</h2>
<p>

</p><pre><code class="language-ruby">require <span class="string"><span class="delimiter">'</span><span class="content">rubygems</span><span class="delimiter">'</span></span> <span class="keyword">if</span> <span class="predefined-constant">RUBY_VERSION</span> &lt; <span class="string"><span class="delimiter">'</span><span class="content">1.9</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">sinatra</span><span class="delimiter">'</span></span>

<span class="keyword">class</span> <span class="class">Route</span> &lt; <span class="constant">Sinatra</span>::<span class="constant">Base</span> 

    get <span class="string"><span class="delimiter">'</span><span class="content">/</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
        <span class="string"><span class="delimiter">"</span><span class="content">Landing page</span><span class="delimiter">"</span></span>
    <span class="keyword">end</span>

    get <span class="string"><span class="delimiter">'</span><span class="content">/client/:clientname</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
    
        param = params[<span class="symbol">:clientname</span>]
        <span class="string"><span class="delimiter">"</span><span class="content">You searched for </span><span class="inline"><span class="inline-delimiter">#{</span>param<span class="inline-delimiter">}</span></span><span class="delimiter">"</span></span>

    <span class="keyword">end</span>

    get <span class="string"><span class="delimiter">'</span><span class="content">/contact</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
        <span class="string"><span class="delimiter">"</span><span class="content">Contact page</span><span class="delimiter">"</span></span>
    <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
<p>QueryString parameters can be accessed using the <strong>params</strong> array, make sure that querystring arguments is a ruby symbol. The get/client call has two lines inside it, but only the last line (which is a string) will be returned by the HTTP request</p>
<h2 id="optional-trailing-slash">4.2 Optional trailing slash</h2>
<p>Make the trailing slash optional in QueryString by adding <strong>/?</strong> in the get method</p>
<pre><code class="language-ruby">require <span class="string"><span class="delimiter">'</span><span class="content">rubygems</span><span class="delimiter">'</span></span> <span class="keyword">if</span> <span class="predefined-constant">RUBY_VERSION</span> &lt; <span class="string"><span class="delimiter">'</span><span class="content">1.9</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">sinatra</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">sinatra/reloader</span><span class="delimiter">'</span></span> <span class="keyword">if</span> development?

<span class="keyword">class</span> <span class="class">Route</span> &lt; <span class="constant">Sinatra</span>::<span class="constant">Base</span> 

    configure <span class="symbol">:development</span> <span class="keyword">do</span>
        register <span class="constant">Sinatra</span>::<span class="constant">Reloader</span>
    <span class="keyword">end</span>

    get <span class="string"><span class="delimiter">'</span><span class="content">/</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
        <span class="string"><span class="delimiter">"</span><span class="content">Landing page</span><span class="delimiter">"</span></span>
    <span class="keyword">end</span>

    get <span class="string"><span class="delimiter">'</span><span class="content">/client/:clientname/?</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
    
        param = params[<span class="symbol">:clientname</span>]
        <span class="string"><span class="delimiter">"</span><span class="content">You searched for </span><span class="inline"><span class="inline-delimiter">#{</span>param<span class="inline-delimiter">}</span></span><span class="delimiter">"</span></span>

    <span class="keyword">end</span>

    get <span class="string"><span class="delimiter">'</span><span class="content">/contact</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
        <span class="string"><span class="delimiter">"</span><span class="content">Contact page</span><span class="delimiter">"</span></span>
    <span class="keyword">end</span>

<span class="keyword">end</span></code></pre>
<p>

</p><h1 id="hot-reloading">5. Hot reloading</h1>
<p>The default setup of Sinatra will not detect any changes in your source file, which means everytime you make a change in the source, you need to stop (CTRL-C) the web server, then start it again. The Sinatra Reloader can help with this.</p>
<p>Before you can use the Sinatra::Reloader, you need to get the gem first. <strong>gem install sintra-contrib</strong></p>
<pre><code class="language-ruby">require <span class="string"><span class="delimiter">'</span><span class="content">rubygems</span><span class="delimiter">'</span></span> <span class="keyword">if</span> <span class="predefined-constant">RUBY_VERSION</span> &lt; <span class="string"><span class="delimiter">'</span><span class="content">1.9</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">sinatra</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">sinatra/reloader</span><span class="delimiter">'</span></span> <span class="keyword">if</span> development?

<span class="keyword">class</span> <span class="class">Route</span> &lt; <span class="constant">Sinatra</span>::<span class="constant">Base</span> 

    configure <span class="symbol">:development</span> <span class="keyword">do</span>
        register <span class="constant">Sinatra</span>::<span class="constant">Reloader</span>
    <span class="keyword">end</span>

    <span class="comment"># APP methods</span>

    get <span class="string"><span class="delimiter">'</span><span class="content">/</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
        <span class="string"><span class="delimiter">"</span><span class="content">Landing page</span><span class="delimiter">"</span></span>
    <span class="keyword">end</span>

    get <span class="string"><span class="delimiter">'</span><span class="content">/client/:clientname</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
    
        param = params[<span class="symbol">:clientname</span>]
        <span class="string"><span class="delimiter">"</span><span class="content">You searched for </span><span class="inline"><span class="inline-delimiter">#{</span>param<span class="inline-delimiter">}</span></span><span class="delimiter">"</span></span>

    <span class="keyword">end</span>

    get <span class="string"><span class="delimiter">'</span><span class="content">/contact</span><span class="delimiter">'</span></span> <span class="keyword">do</span>
        <span class="string"><span class="delimiter">"</span><span class="content">Contact page</span><span class="delimiter">"</span></span>
    <span class="keyword">end</span>

<span class="keyword">end</span></code></pre>
<p>Just <em>require</em> the sinatra/reloader and register it inside your app, like the code above. Now, there is no need to restart the web server when changes occur in the source file. Use this only for development, not in production. There are other ways to achieve hot-reloading, go to the <a href="http://www.sinatrarb.com/faq.html">Sinatra FAQ</a></p>
	  </div>
		<p/>



    <!-- Start of StatCounter Code for Default Guide -->
	
  <script type="text/javascript">
  var sc_project=7827488; 
  var sc_invisible=1; 
  var sc_security="069357c9"; 
  </script>
  <script type="text/javascript"
      src="http://www.statcounter.com/counter/counter.js"></script>
  <noscript><div class="statcounter"><a title="customizable
      counter" href="http://statcounter.com/free-hit-counter/"
      target="_blank"><img class="statcounter"
      src="http://c.statcounter.com/7827488/0/069357c9/1/"
      alt="customizable counter"></a></div></noscript>
  <!-- End of StatCounter Code for Default Guide -->
   
    
<!--
<p/></p><p/></p>
<strong>For discussions,</strong> please use <a href="https://groups.google.com/group/thelogbox">theLogBox Google Group</a>. Follow me on <a href="https://twitter.com/thelogbox">Twitter</a> or <a href="https://facebook.com/thelogbox.dev">Facebook.com/thelogbox.dev</a>

-->

<div id="mc_embed_signup">
<form action="http://thelogbox.us5.list-manage.com/subscribe/post?u=ccf5609c10396fa44241f5400&amp;id=0117706770" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
	
<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="To get our updates, enter your email here" required>
<div class="clear">  
  <input type="submit" value="Subscribe"
  name="subscribe" id="mc-embedded-subscribe"
  class="button">
</div>
</form>
</div>

    <footer>
      &copy 2009-2013 theLogBox.com 

    </foter>

    </div>
  </body>

</html>

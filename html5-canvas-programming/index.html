<!DOCTYPE HTML>
<html lang="en">
  <head>
		<style>

* {
  font-size: 16px;
  background: #FFFFFF;
  color: #545454;
}

ul, ol, li, p {
  font-family: Arial ;
  line-height: 160%;
}

em {
  font-family: Georgia;
  color: #41505d;
}

strong {
  color: #000000;
}

img {
  display:block;
  margin-left: auto;
  margin-right: auto;
  width: 100%;
}
  img.shadow {
    display:block;
    margin-left: auto;
    margin-right: auto;
    width: 85%;
    -moz-box-shadow: -5px 0 35px 10px #888;
    -webkit-box-shadow: -5px 0 35px 10px #888;
    box-shadow: -5px 0 35px 10px #888;
    margin-top: 40px;
    margin-bottom: 40px;
  } 
  img.small {
    width: 40%;
    -moz-box-shadow: -5px 0 35px 10px #888;
    -webkit-box-shadow: -5px 0 35px 10px #888;
    box-shadow: -5px 0 35px 10px #888;
    margin-top: 40px;
    margin-bottom: 40px;
  }
  img.default {
    width: inherit;
  }
  

#shock-left {
  font-family: 'Rokkitt';
  font-weight:normal;
  letter-spacing: -1.5px;
  color: #61768a;
  text-align: center;
  width: 100%;
  float:left;
  height: 5em;
  padding-top:10px;
  margin-top:50px;
}

  #shock-left a:link, #shock-left a:visited {
    font-size: 45px;
    /*color: #61768a;*/
    color: #292929;
    border-bottom: 2px dotted #000000;
  }
  #shock-left a:hover {
    color: #61768a;
    border-bottom: 2px solid #61768a;;
  }

  #shock-right {
    padding-top:70px;
    font-size: 75px;
    font-weight: bold;
    font-family: 'Rokkitt';
    letter-spacing: -1.5px;
    line-height: -.7em;
    /*color: #61768a;*/
    color: #292929;
    text-align:center;
  }

/*
#shock-right {
  font-size: 350%;
  font-weight:bold;
  letter-spacing: -1.5px;
  color: #004646;
  float: right;
  height: 250px;
  width:40%;
  padding-top:30px;
  text-align: right;
  margin-right:50px;
}
*/
  
body {
  font-family: Arial;
  width: 85%;
  margin-left: auto;
  margin-right: auto;
}

header {
  height:4.5em;
  margin-top:10px;
  border-bottom:0px dotted #009494;
}

#navleft, #navright {font-family: 'Rokkitt';}
#navleft a:link, #navleft a:visited {
  font-size: 22px;
  color: #CACACA;
  float:left;
  font-weight:normal;
  margin-left:0px;
}
  #navleft a:hover {
    color: #61768a;
    border-bottom: 0px solid #61768a;
  }

#navright a:link, #navright a:visited {
  font-size: 22px;
  padding-left:5px;
  padding-right:5px;
  float:right;
  color: #CACACA;
  text-decoration:none;
}

  #navright a:hover {
    color: #61768a;
    border-bottom:0px solid #DEDEDE;
  }

  .currentdir {
    font-family: 'Rokkitt';
    font-size: 22px;
    color: #000000;
    padding: 3px;
  }  

#spacer {clear:both;margin-bottom:50px;}

#inner {

}
footer {
  font-size: 120%;
  text-align: center;
  clear:both;
  display:block;
  font-size: 90%;
  margin-top: 100px;
  margin-bottom: 30px;
}

/* Headings and Titles */

#trainingtitle {
  font-family: 'Rokkitt';
  color: #61768a;
  font-size: 350%;
  font-weight: normal;
  text-align: left;
  padding-top: 20px;
}

#articletitle {
  font-family: 'Tauri';
  font-size:60px; 
  font-weight: normal;
  color: #292929;
  margin-top:0px;
  margin-bottom: 40px;
  text-align: center;
  letter-spacing: -1px;
}

h2, h3, h4, h5 {
  font-family: Arial;
  /*color: #61768a;*/
  color: #373737; 
  font-weight:normal;
}
h1 {
  font-family:'Tauri'; 
  font-size: 200%;
  letter-spacing: -1px;
}
h2 {font-size: 140%;}
  h2.section { border-bottom: 1px solid #CACACA;}
h3 {font-size: 120%;}
h4 {font-size: 110%;}

/* LINKS */

a:link, a:visited {
  /*color: #004a94;
  color: #0778e4;*/
  color: #b30000;
  text-decoration: none;
}

a:hover {
  color: #0072e3;
  border-bottom: 1px solid #0072e3;
}

hr {
  background: #61781a;
  color: #61781a;
  border: 3px solid #DEDEDE;
}

/* OTHER BLOCKS */

#minitoc {

  color: #4E4E4E;
  width: 35%;
  float: right;
  margin-left:30px;
  
  margin-bottom:30px;
  padding-top: 10px;
  padding-bottom:20px;
  border: 3px solid #E8E8E8;  
  padding-left:10px;
  padding-right:20px;
    
  line-height:20px;   
}

#contentmeta {
  font-family: 'Rokkitt';
  font-style: normal;
  color: gray;
  text-align: left;
  text-align: center;
  margin-bottom: 20px;
}

#sidebarright {
  float: right;
  width:300px;
  /* background: #FFFFC8; */
  border: 1px solid #FFA500;
  padding: 20px;
  margin-left: 20px;
}

/* MAIL CHIMP CSS*/

#mce-EMAIL {
  font-size: 20px;
  letter-spacing: -1px;
  color: #000000;
  width: 60%;
  background: #FFFFF6;
  border:3px solid #000000;
  margin-bottom: 10px;
  padding-top: 10px;
  padding-bottom: 10px;
  padding-left: 20px;
  height: 15px;
  text-align:center;
}

#mc-embedded-subscribe {
  font-family: Arial;
  background: #000000;
  color: #FFFFFF;
  padding: 10px 15px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  cursor: pointer;
  text-align: center;
  width: 200px;
  border: 0px;
  font-size: 25px;
}

#mc-embedded-subscribe:hover {
  background: #0072e3;
}  

#mc_embed_signup {
  border: 0px solid #618a8a ;
  margin-top: 50px;
  padding-top: 0px;
  padding-bottom: 20px;
  padding-left: 0px;
  text-align: center;
}

/* MAIL CHIMP CSS*/

/* PRE AND CODE AREA */

#lst {  
  font-family: Georgia;
  font-size: 16px;
  text-align: center;
  margin: 15px;
  color: #000000;
}

pre {

  margin-top: 15px;
  margin-bottom:0px;

  padding: 10px 5px 10px 15px;
  
  /*font-size: .87em;*/
  font-size: 14px;
  font-family: 'Muli';
  background: #e8ebef;
  line-height: 130%;
  white-space: pre-wrap;
  
  /*
  border: 1px solid #DEDEDE;
  background: #FBFCF9; 
  */
  /*
  border: 1px solid #DEDEDE;
  background: #F5F5F5;
  color: #000;

  -moz-border-radius: 10px;
  -webkit-border-radius: 10px;  
  border-radius: 10px;
  */

}

pre.codeblock, .codeblock {
  
  font-family: 'Muli';
  font-size: 15px;
  color: #0000b3;
  background: #FFFFFF;
  padding:0px;
  margin: 0px;
}


pre code, .keyword, .directive, .type, 
          .string, .function, .class, 
          .reserved, .content, .comment, 
          .predefined-type, .preprocessor, .tag,
          .attribute-name, .include, .predefined-constant, 
          .local-variable, .key, .class, .instance-variable,
          .symbol, .constant, .inline, .line-numbers,
          .integer, .char, .float, .annotation, .namespace, 
          .content, .delimiter, .st, .sourceCode, .exception,
          .class-variable, .doctype{

      font-family: 'Muli';
      /*font-size: 1em;*/
      font-size: 14px;
      background: #e8ebef; 
      color: #000000;
      line-height: 130%;

}

/* definition of styles for code highlighting */

/*
.keyword, .key, .directive, .type, .reserved, .predefined-type, .tag, .class {
  color: #6e6eFF;
}

.predefined-constant {
  color: gray;
}

.line-numbers {

  font-size: 70%;
  padding-right: 10px;
  color: #8E8E8E;
  font-family: 'Source Code Pro', Courier, "Courier New", monospace;
}

.include, .preprocessor, .attribute-name {
  color: #CD7300;
}

.string {
  color: #6C0000;
}

.comment {
  color: : gray;
}

.function, .class  {
  color: #2828A8;
}

.local-variable {
  color: blue;
}

*/
</style>
		<!--

<link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>

-->

<meta charset="utf-8">
<title>HTML5 Canvas Programming &mdash; theLogBox.com</title>

<link href='http://fonts.googleapis.com/css?family=Rokkitt:400,700' rel='stylesheet' type='text/css'>

<link href='http://fonts.googleapis.com/css?family=Muli' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Tauri' rel='stylesheet' type='text/css'>

<!--
<link rel="stylesheet" type="text/css" href="/style.css" media="screen">
-->



		<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-38198657-1']);
  _gaq.push(['_setDomainName', 'thelogbox.com']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>	
  </head>
  <body>

    <div id="main" itemscope itemtype="http://schema.org/Article">

	  <header>
      
<div id='navleft'>
<a href='/'><span class="currentdir">theLogBox</a>
</div>

<div id='navright'>
  <a href='/courses/'>courses</a> &nbsp;&nbsp;
  <a href='/blog/'>blog</a> &nbsp;&nbsp;
  <a href='/tutorials/'>tutorials</a>
</div>
    </header>

    <div id='contentmeta'>
by: 

<a href="https://plus.google.com/u/0/100317694679641558339?rel=author">
  Ted Hagos
</a> on 

<span itemprop="dateCreated"> October 18, 2012 </span>
</div>  
	  <div id="articletitle" itemprop="headline">HTML5 Canvas Programming</div>  
   

	  <div itemprop="articleBody">
      <div id="update-history">
<h3>
Doc History
</h3>
<br> 18.Oct.2012 — created<br> 22.Oct.2012 — rewrite sections, added basic straight line and circular movements<br> 28.Oct.2012 — added some sections on acceleration. embedded live demo within tutorial<br>
</div>


<div id="minitoc">
<h3>
Contents
</h3>

<ol start="0" style="list-style-type: decimal">
<li>Prep</li>
<li>Basic plumbing
<ul>
<li>Drawing primitives</li>
<li>Timed animation</li>
</ul>
</li>
<li>Basic movements
<ul>
<li>Moving in a straight line</li>
<li>Moving in a uniform circular motion</li>
</ul>
</li>
<li>Acceleration
<ul>
<li>Accelerate, then stop</li>
</ul>
</li>
</ol>
</div>

<h1 id="prep">Prep</h1>
<p>
</p><ol style="list-style-type: decimal">
<li>HTML5 compliant browser. It is easy to find out, open whatever browser you are using and go http://html5test.com</li>
<li>Good programmer's editor</li>
<li>JQuery</li>
<li>CoffeeScript</li>
<li>Haml</li>
<li>Sass</li>
<li>Source control (git, mercurial, svn, cvs etc), whatever you are comfortable with</li>
</ol><p>Item numbers 3 until 8, you can live without (I suggest you don't though)</p>
<h2 id="prior-knowledge">Prior knowledge</h2>
<p>You need a (really) solid background on <strong>JavaScript</strong>, a passing knowledge of the lanaguage might tie you up for drawing some simplistic primitives and less complex animations (straight line movements with fewer than 10 objects), however, when the complications gets to a higher order (lots of objects flying around independently, oscillations, movements along curvatures etc), it means only one thing--time to get some more programming knowledge and experience. A really good book will help, a really good teacher/mentor/community support will be even better.</p>
<p>Programmers coming from other languages (such as Java, C++, Ruby, Python) who are quite adept with data structures and algorithms will feel right at home. HTML5 canvas programming requires programming experience because it is quite close to the metal. There are frameworks that may help doing some basic animations, but you do really need to understand the JavaScript language, be comfortable structuring data (in OO way would be very helpful) and you need to genuinely enjoy breaking down problems into component solutions. As mentioned before, it is close to the metal programming; canvas lets you manipulate individual pixels in a bounded region, after that, you are pretty much on your own.</p>
<h1 id="basic-plumbing">1. Basic plumbing</h1>
<p>A canvas HTMLElement needs to be defined in the page.</p>
<pre><code class="language-html"><span class="doctype">&lt;!DOCTYPE html&gt;</span>
<span class="tag">&lt;html&gt;</span>
  <span class="tag">&lt;head&gt;</span><span class="tag">&lt;/head&gt;</span>
  <span class="tag">&lt;style&gt;</span>#mycanvas {border:1px solid gray;}<span class="tag">&lt;/style&gt;</span>
  <span class="tag">&lt;title&gt;</span>"canvas programming"<span class="tag">&lt;/title&gt;</span>
  <span class="tag">&lt;script&gt;</span><span class="inline">src=<span class="string"><span class="delimiter">"</span><span class="content">canvas.js</span><span class="delimiter">"</span></span></span><span class="tag">&lt;/script&gt;</span>
  <span class="tag">&lt;body&gt;</span>
    <span class="tag">&lt;canvas</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">'</span><span class="content">mycanvas</span><span class="delimiter">'</span></span><span class="tag">&gt;</span>width=500 height=300<span class="tag">&lt;/canvas&gt;</span>
  <span class="tag">&lt;/body&gt;</span>
<span class="tag">&lt;/html&gt;</span></code></pre>
<p>

</p><pre><code class="language-javascript"><span class="comment">// filename: canvas.js</span>

window.<span class="function">onload</span> = <span class="keyword">function</span>(){
    
    <span class="keyword">var</span> canv = document.getElementById(<span class="string"><span class="delimiter">"</span><span class="content">mycanvas</span><span class="delimiter">"</span></span>);
    <span class="keyword">var</span> context = canv.getContext(<span class="string"><span class="delimiter">"</span><span class="content">2d</span><span class="delimiter">"</span></span>);
    
}</code></pre>
<p>The HTMLElement canvas is not the programming platform, you need it simply to get the actual reference to the 2d platform. The <strong>mycanvas</strong> is just a DOM element, think of it as a viewport, you cannot paint 2d drawing primitives in that element. The <strong>context</strong> object is the 2d platform, use this to draw the drawing primitives.</p>
<h2 id="drawing-primitives-of-the-canvas">1.1 Drawing primitives of the Canvas</h2>
<p>
</p><pre><code class="language-javascript"><span class="comment">// filename: canvas.js</span>

window.<span class="function">onload</span> = <span class="keyword">function</span>(){

    <span class="keyword">var</span> canv = document.getElementById(<span class="string"><span class="delimiter">"</span><span class="content">mycanvas</span><span class="delimiter">"</span></span>);
    <span class="keyword">var</span> context = canv.getContext(<span class="string"><span class="delimiter">"</span><span class="content">2d</span><span class="delimiter">"</span></span>);

    ctx.fillRect(<span class="integer">10</span>,<span class="integer">10</span>,<span class="integer">50</span>,<span class="integer">50</span>);
    ctx.strokeRect(<span class="integer">70</span>,<span class="integer">10</span>,<span class="integer">50</span>,<span class="integer">50</span>);

    ctx.fillStyle = <span class="string"><span class="delimiter">"</span><span class="content">rgb(255,0,0)</span><span class="delimiter">"</span></span>;
    ctx.fillRect(<span class="integer">10</span>,<span class="integer">70</span>,<span class="integer">50</span>,<span class="integer">50</span>);

    ctx.strokeStyle = <span class="string"><span class="delimiter">"</span><span class="content">#ababab</span><span class="delimiter">"</span></span>;
    ctx.strokeRect(<span class="integer">70</span>,<span class="integer">70</span>,<span class="integer">50</span>,<span class="integer">50</span>);

    <span class="comment">// DRAW LINES</span>

    <span class="comment">//The line is gray bec the curr strokeStyle</span>
    <span class="comment">//is #ababab</span>

    ctx.lineWidth = <span class="integer">1</span>;
    ctx.beginPath();
    ctx.moveTo(<span class="integer">130</span>, <span class="integer">130</span>);
    ctx.lineTo(<span class="integer">0</span>,<span class="integer">0</span>);
    ctx.closePath();
    ctx.stroke();

    <span class="comment">// DRAW some text</span>

    ctx.fillText(<span class="string"><span class="delimiter">"</span><span class="content">Hello</span><span class="delimiter">"</span></span>, <span class="integer">130</span>,<span class="integer">20</span>);
    ctx.font = <span class="string"><span class="delimiter">"</span><span class="content">40px serif</span><span class="delimiter">"</span></span>; <span class="comment">// you can add italics here, just like in css</span>
    ctx.fillText(<span class="string"><span class="delimiter">"</span><span class="content">Hello</span><span class="delimiter">"</span></span>, <span class="integer">130</span>,<span class="integer">60</span>);
    ctx.strokeText(<span class="string"><span class="delimiter">"</span><span class="content">Hello</span><span class="delimiter">"</span></span>, <span class="integer">130</span>,<span class="integer">100</span>);

    <span class="comment">//DRAW CIRCLE</span>

    ctx.fillStyle = <span class="string"><span class="delimiter">"</span><span class="content">green</span><span class="delimiter">"</span></span>;
    ctx.beginPath();
    ctx.arc(<span class="integer">60</span>,<span class="integer">180</span>,<span class="integer">50</span>,<span class="integer">0</span>,Math.PI * <span class="integer">2</span>, <span class="predefined-constant">false</span>);
    ctx.closePath();
    ctx.fill();

    ctx.fillStyle = <span class="string"><span class="delimiter">"</span><span class="content">orange</span><span class="delimiter">"</span></span>;
    ctx.beginPath();
    ctx.arc(<span class="integer">60</span>,<span class="integer">280</span>,<span class="integer">50</span>,<span class="integer">0</span>,Math.PI, <span class="predefined-constant">false</span>);
    ctx.closePath();
    ctx.fill();

}</code></pre>
<p>Lots of things you can do with the <strong>context (ctx)</strong> object, in fact, everything has to be drawn using the context object, you need to be very comfortable with it. The sample code above demonstrates some primitives of the context object (line, text and arc). There are more examples of Canvas basics at <a href="http://www.html5canvastutorials.com/tutorials/html5-canvas-tutorials-introduction/">HTML5 Canvas tutorials</a></p>
<h2 id="animation-using-a-timer">1.2 Animation using a timer</h2>
<p>Using barebones JavaScript should still be okay to use for the following examples, but there is no point delaying using the tools mentioned in <strong>Section 0</strong>, so we will use them.</p>
<h2 id="prep-steps">Prep Steps</h2>
<ol style="list-style-type: decimal">
<li>Download <a href="http://jquery.com/download/">jquery-1.8.x.js</a> and put it on same directory where the .coffee files and .haml files are</li>
<li>Get Haml (via rubygems), <strong>gem install haml</strong>
</li>
<li>Get coffeescript (via node package manager) <strong>npm -g install coffee-script</strong>
</li>
</ol><p>

</p><pre><code class="language-haml"><span class="comment">/ filename: animate.haml</span>
<span class="comment">/ compile: haml animate.haml animate.html</span>

<span class="comment">/ author: Ted Hagos</span>

<span class="doctype">!!!5</span>

<span class="tag">%html</span>
    <span class="tag">%head</span>
        <span class="tag">%title</span> Basic Time Animation

        <span class="tag">%script</span>{<span class="symbol">:src</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">jquery-1.8.1.js</span><span class="delimiter">"</span></span>}
        <span class="tag">%script</span>{<span class="symbol">:src</span> =&gt;  <span class="string"><span class="delimiter">"</span><span class="content">animate.js</span><span class="delimiter">"</span></span>}

    <span class="tag">%body</span>

        <span class="tag">%canvas</span>{<span class="symbol">:id</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">mycanvas</span><span class="delimiter">"</span></span>, <span class="symbol">:width</span> =&gt; <span class="integer">500</span>, <span class="symbol">:height</span> =&gt; <span class="integer">300</span>}</code></pre>
<p>

</p><pre><code class="language-ruby"><span class="comment">###</span>

<span class="constant">BSD</span> <span class="constant">License</span>: <span class="constant">Copyright</span> (c) <span class="integer">2009</span>-<span class="integer">2012</span> <span class="constant">Ted</span> <span class="constant">Hagos</span>
<span class="constant">All</span> rights reserved.

License text: http<span class="symbol">:/</span>/thelogbox.com/source-docs/software-license.txt
    
<span class="comment">###</span>

<span class="comment">###</span>

filename: animate.coffee
compile: coffee --compile animate.coffee 

<span class="constant">Desc</span>:

    <span class="constant">Basics</span> of a game loop
    <span class="integer">1</span>. Update positions of objects <span class="keyword">in</span> the canvas
    <span class="integer">2</span>. Clear the canvas
    <span class="integer">3</span>. Redraw eveything <span class="keyword">in</span> the canvas

    <span class="constant">This</span> one is pretty basic, it draws a square primitive
    everytime the canvas is redrawn. Experiment with the
    code by removing the hash sign (comment) before the
    line <span class="string"><span class="delimiter">"</span><span class="content">ctx.clearRect...</span><span class="delimiter">"</span></span> <span class="keyword">if</span> that line is commented out
    <span class="keyword">then</span> the screen will fill up with random sized squares
    overtime; <span class="keyword">if</span> the line is <span class="keyword">not</span> commented, a randomly sized
    square object will appear everytime the canvas is 
    redrawn

<span class="comment">###</span>

<span class="keyword">class</span> <span class="class">Paper</span>

    c = <span class="integer">0</span>;
    ctx = <span class="integer">0</span>;
    counter = <span class="integer">0</span>;

    constructor: (canvas,context) -&gt; 
        c = canvas
        ctx = context
        <span class="instance-variable">@draw</span>()

    draw: =&gt;
        <span class="comment">#ctx.clearRect 0, 0, c.width, c.height</span>
        sq = <span class="constant">Square</span>.getSquare(c)
        ctx.strokeRect sq.x, sq.y, sq.width, sq.height
        setTimeout <span class="instance-variable">@draw</span>, <span class="integer">300</span>


<span class="keyword">class</span> <span class="class">Square</span>

    <span class="instance-variable">@getSquare</span>: (canvas) -&gt;
        x = <span class="constant">Math</span>.random() * canvas.width
        y = <span class="constant">Math</span>.random() * canvas.height
        width = <span class="constant">Math</span>.random() * <span class="integer">75</span>
        height = width
        {x, y, width, height}

<span class="error">$</span>(window).ready -&gt;
    canvas = <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">#mycanvas</span><span class="delimiter">'</span></span>).get(<span class="integer">0</span>)
    context = canvas.getContext(<span class="string"><span class="delimiter">'</span><span class="content">2d</span><span class="delimiter">'</span></span>)

    paper = new Paper(canvas,context)</code></pre>
<p>

</p><h1 id="basic-movements">2. Basic movements</h1>
<h2 id="moving-in-a-straight-line">2.1 Moving in a straight line</h2>
<p>

</p><pre><code class="language-haml"><span class="comment">/ filename: straight.haml</span>
<span class="comment">/ compile: haml straight.haml straight.html</span>

<span class="comment">/ author: Ted Hagos</span>

<span class="doctype">!!!5</span>

<span class="tag">%html</span>
    <span class="tag">%head</span>
        <span class="tag">%script</span>{<span class="symbol">:src</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">jquery-1.8.1.js</span><span class="delimiter">"</span></span>}
        <span class="tag">%script</span>{<span class="symbol">:src</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">straight.js</span><span class="delimiter">"</span></span>}

    <span class="tag">%body</span>
        <span class="tag">%canvas</span>{<span class="symbol">:id</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">mycanvas</span><span class="delimiter">"</span></span>, <span class="symbol">:width</span> =&gt; <span class="integer">500</span>, <span class="symbol">:height</span> =&gt; <span class="integer">300</span>, <span class="symbol">:style</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">border:1px solid gray</span><span class="delimiter">"</span></span>}</code></pre>
<p>
</p><pre><code class="language-ruby"><span class="comment">###</span>

<span class="constant">BSD</span> <span class="constant">License</span>: <span class="constant">Copyright</span> (c) <span class="integer">2009</span>-<span class="integer">2012</span> <span class="constant">Ted</span> <span class="constant">Hagos</span>
<span class="constant">All</span> rights reserved.

License text: http<span class="symbol">:/</span>/thelogbox.com/source-docs/software-license.txt

<span class="comment">###</span>

<span class="comment">####</span>

filename: straight.coffee
compile: coffee --compile straight.coffee

<span class="constant">Desc</span>: 

    <span class="constant">Basic</span> horizontal movement of a context primitive. Each time the screen is
    redrawn (setTimeout <span class="instance-variable">@draw</span>, <span class="integer">30</span>), the y-coordinate of the box object is
    incremented

    <span class="constant">This</span> code sample also demonstrates basic principle of collision detection,
    once the right edge of the box object (box.x + box.width) has touched the right
    edge of canvas ( &gt; c.width), we stop redrawing the canvas--sure the <span class="constant">JavaScript</span>
    timer goes chugging along still, you cannot stop it, but there is an branching
    of the logic inside the draw() function -- <span class="keyword">unless</span> stop_drawing is <span class="predefined-constant">true</span>, we 
    draw, <span class="keyword">if</span> stop_drawing is <span class="predefined-constant">true</span> already, we stop

<span class="comment">####</span>


<span class="keyword">class</span> <span class="class">Stage</span>

    c = ctx = box = null
    stop_drawing = <span class="predefined-constant">false</span>

    constructor: (canvas, context) -&gt;
        c = canvas
        ctx = context

        box = 
            x: <span class="integer">10</span>
            y: c.height <span class="regexp"><span class="delimiter">/</span><span class="content">2
            width: 40
            height: 40
            speed: 1

        @draw()

    draw: =&gt;

        unless stop_drawing

            ctx.clearRect 0, 0, c.width, c.height
            box.x += box.speed
            ctx.strokeRect box.x, box.y, box.width, box.height
            setTimeout @draw, 30

            if box.x + box.width is c.width then stop_drawing = true


$(window).ready -&gt;
    canvas = $('#mycanvas').get(0)
    context = canvas.getContext('2d')

    stage = new Stage(canvas, context)</span></span></code></pre>
<p>

</p><h2 id="moving-in-a-uniform-circular-motion">2.2 Moving in a uniform circular motion</h2>
<p>There is no direct way to make a an object move along a circular path. The circular path has to be calculated, then set the <em>x,y</em> of the object to move along those coordinates</p>
<!--
<img src="/res/article-pix/notes-canvas/circlepath.png" width=500/>
-->
<iframe src="/source-docs/circlepath.html" width="100%" height="350px" frameborder="0">
</iframe>

<p>

</p><pre><code class="language-haml"><span class="comment">/ filename: circlepath.haml</span>
<span class="comment">/ compile: haml circlepath.haml circlepath.html</span>

<span class="comment">/ author: Ted Hagos</span>

<span class="doctype">!!!5</span>

<span class="tag">%html</span>
    <span class="tag">%head</span>

    <span class="tag">%script</span>{<span class="symbol">:src</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">jquery-1.8.1.js</span><span class="delimiter">"</span></span>}
    <span class="tag">%script</span>{<span class="symbol">:src</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">circlepath.js</span><span class="delimiter">"</span></span>}

<span class="tag">%body</span>
    <span class="tag">%canvas</span>{<span class="symbol">:id</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">mycanvas</span><span class="delimiter">"</span></span>, <span class="symbol">:width</span> =&gt; <span class="integer">600</span>, <span class="symbol">:height</span> =&gt; <span class="integer">600</span>}
    <span class="constant">#watch</span></code></pre>
<p>

</p><pre><code class="language-ruby"><span class="comment">###</span>

<span class="constant">BSD</span> <span class="constant">License</span>: <span class="constant">Copyright</span> (c) <span class="integer">2009</span>-<span class="integer">2012</span> <span class="constant">Ted</span> <span class="constant">Hagos</span>
<span class="constant">All</span> rights reserved.

License text: http<span class="symbol">:/</span>/thelogbox.com/source-docs/software-license.txt
    
<span class="comment">###</span>

<span class="comment">###</span>

filename: circlepath.coffee
compile: coffee --compile circlepath.coffee

<span class="constant">Desc</span>:
    <span class="constant">Trace</span> the path of circle object (defined <span class="keyword">in</span> the constructor). That specific
    circle will <span class="keyword">not</span> be drawn, but instead its perimeter will be used as the 
    path as we draw (<span class="keyword">and</span> animate) a smaller circle (drawn using ctx.arc) 
    
<span class="comment">###</span>


<span class="keyword">class</span> <span class="class">Paper</span>

    c = null
    ctx = null

    ball = {}
    circle = {}

    counter = <span class="integer">0</span>

    constructor: (canvas, context) -&gt;
        c = canvas
        ctx = context
        <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">#watch</span><span class="delimiter">'</span></span>).html <span class="string"><span class="delimiter">"</span><span class="content">On the CTOR</span><span class="delimiter">"</span></span>

        ball = 
            x:<span class="integer">0</span>
            y:<span class="integer">0</span>
            speed: <span class="float">0.1</span>

        circle = 
            centerX: <span class="integer">250</span>
            centerY: <span class="integer">250</span>
            radius: <span class="integer">125</span>
            angle: <span class="integer">0</span>

    draw: =&gt;
        
        counter += <span class="integer">1</span>
        
        ctx.clearRect <span class="integer">0</span>, <span class="integer">0</span>,  c.width, c.height
        ball.x = circle.centerX + <span class="constant">Math</span>.cos(circle.angle) * circle.radius
        ball.y = circle.centerY + <span class="constant">Math</span>.sin(circle.angle) * circle.radius

        ctx.beginPath()
        ctx.arc ball.x, ball.y, <span class="integer">15</span>, <span class="integer">0</span>, <span class="constant">Math</span>.PI * <span class="integer">2</span>, <span class="predefined-constant">true</span>
        ctx.closePath()
        ctx.stroke()

        circle.angle += ball.speed
        
        <span class="comment"># why is this not being called</span>
        
        <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">#watch</span><span class="delimiter">'</span></span>).html <span class="string"><span class="delimiter">"</span><span class="content">Loop counter = </span><span class="inline"><span class="inline-delimiter">#{</span>counter<span class="inline-delimiter">}</span></span><span class="delimiter">"</span></span>
        setTimeout <span class="instance-variable">@draw</span>, <span class="integer">1000</span>


<span class="error">$</span>(window).ready -&gt;
    canvas = <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">#mycanvas</span><span class="delimiter">'</span></span>).get(<span class="integer">0</span>)
    context = canvas.getContext(<span class="string"><span class="delimiter">'</span><span class="content">2d</span><span class="delimiter">'</span></span>)

    paper = new Paper(canvas, context)
    paper.draw()</code></pre>
<p></p>

<h1 id="acceleration">3. Acceleration</h1>
<p>To immitate the motion of freely falling bodies, the downward movement along a straight line needs to incorporate acceleration. Our box need not only update its <em>y</em> position, it also needs to update its speed. Each time the canvas is redrawn, the speed increases <em>(box.speed += box.acceleration)</em></p>
<iframe src="/source-docs/acceleration.html" width="100%" height="550px" frameborder="0">
</iframe>

<pre><code class="language-haml"><span class="comment">/ filename: acceleration.haml</span>
<span class="comment">/ author: Ted Hagos</span>


<span class="doctype">!!!5</span>

<span class="tag">%html</span>
    <span class="tag">%head</span>
        <span class="tag">%link</span>{<span class="symbol">:rel</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">stylesheet</span><span class="delimiter">"</span></span>, <span class="symbol">:href</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">stylesheet.css</span><span class="delimiter">"</span></span>}
        <span class="tag">%script</span>{<span class="symbol">:src</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">http://code.jquery.com/jquery-1.8.2.min.js</span><span class="delimiter">"</span></span>}
        <span class="tag">%script</span>{<span class="symbol">:src</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">jcanvas.min.js</span><span class="delimiter">"</span></span>}
        <span class="tag">%script</span>{<span class="symbol">:src</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">acceleration.js</span><span class="delimiter">"</span></span>}
    <span class="tag">%body</span>
        <span class="tag">%canvas</span>{<span class="symbol">:id</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">mycanvas</span><span class="delimiter">'</span></span>, <span class="symbol">:width</span> =&gt; <span class="integer">500</span>, <span class="symbol">:height</span> =&gt; <span class="integer">500</span>, <span class="symbol">:style</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">border: 1px solid gray</span><span class="delimiter">"</span></span>}</code></pre>
<p></p>

<pre><code class="language-ruby"><span class="comment">###</span>

<span class="constant">BSD</span> <span class="constant">License</span>: <span class="constant">Copyright</span> (c) <span class="integer">2009</span>-<span class="integer">2012</span> <span class="constant">Ted</span> <span class="constant">Hagos</span>
<span class="constant">All</span> rights reserved.

License text: http<span class="symbol">:/</span>/thelogbox.com/source-docs/software-license.txt
    
<span class="comment">###</span>

<span class="comment"># filename: accelerate.coffee</span>
<span class="comment"># date: Sat Oct 27 15:33:22 PHT 2012 </span>

<span class="comment">###</span>

<span class="constant">To</span> accelerate, increase the speed of the box each time it is redrawn. 

<span class="comment">###</span>

class <span class="constant">Stage</span> 

    c = ctx = box = null
    stopAnimation = <span class="predefined-constant">false</span>

    constructor: (canvas, context) -&gt;
        c = canvas
        ctx = context

        box = 
            x: c.width/<span class="integer">2</span>
            y: <span class="integer">0</span>
            width: <span class="integer">10</span>
            height: <span class="integer">10</span>
            speed: <span class="integer">1</span> 
            acceleration: .<span class="error">98</span> 

        <span class="instance-variable">@draw</span>()

    draw: =&gt;

        <span class="keyword">unless</span> box.y &gt; c.height

            ctx.clearRect <span class="integer">0</span>,<span class="integer">0</span>, c.width, c.height
            box.y += box.speed
            box.speed += box.acceleration

            ctx.strokeRect box.x, box.y, box.width, box.height
            setTimeout <span class="instance-variable">@draw</span>, <span class="integer">60</span>

            <span class="keyword">if</span> box.y &gt; c.height
                box.speed = <span class="integer">1</span>
                box.y = <span class="integer">0</span>
                box.x = <span class="constant">Math</span>.random() * c.width


<span class="error">$</span>(window).ready -&gt;
    canvas = <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">#mycanvas</span><span class="delimiter">'</span></span>).get(<span class="integer">0</span>)
    context = canvas.getContext(<span class="string"><span class="delimiter">'</span><span class="content">2d</span><span class="delimiter">'</span></span>)

    stage = new Stage(canvas, context)</code></pre>
<h2 id="accelerate-then-stop">3.1 Accelerate, then stop</h2>
<p>Combination of techniques now. Make the box accelerate as it falls down, then detect if the bottom of the box <em>(box.y + box.height)</em> has already touched the canvas floor <em>(canvas.height)</em>. Make the box rest there.</p>
<p>Click <strong>fall</strong> button below to see the demo</p>
<iframe src="/source-docs/fall-stop.html" width="100%" height="550px" frameborder="0">
</iframe>

<pre><code class="language-haml"><span class="comment">/ filename: fall-stop.haml</span>
<span class="comment">/ author: Ted Hagos</span>


<span class="doctype">!!!5</span>

<span class="tag">%html</span>
    <span class="tag">%head</span>
        <span class="tag">%script</span>{<span class="symbol">:src</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">http://code.jquery.com/jquery-1.8.2.min.js</span><span class="delimiter">"</span></span>}
        <span class="tag">%script</span>{<span class="symbol">:src</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">fall-stop.js</span><span class="delimiter">"</span></span>}
    <span class="tag">%body</span>
        <span class="tag">%canvas</span>{<span class="symbol">:id</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">mycanvas</span><span class="delimiter">'</span></span>, <span class="symbol">:width</span> =&gt; <span class="integer">500</span>, <span class="symbol">:height</span> =&gt; <span class="integer">500</span>, <span class="symbol">:style</span> =&gt; <span class="string"><span class="delimiter">"</span><span class="content">border: 1px solid gray</span><span class="delimiter">"</span></span>}</code></pre>
<p></p>

<pre><code class="language-ruby"><span class="comment">###</span>

<span class="constant">BSD</span> <span class="constant">License</span>: <span class="constant">Copyright</span> (c) <span class="integer">2009</span>-<span class="integer">2012</span> <span class="constant">Ted</span> <span class="constant">Hagos</span>
<span class="constant">All</span> rights reserved.

License text: http<span class="symbol">:/</span>/thelogbox.com/source-docs/software-license.txt
    
<span class="comment">###</span>

<span class="comment"># filename: fall-stop.coffee</span>
<span class="comment"># date: Sat Oct 27 19:13:30 PHT 2012</span>

<span class="comment">###</span>

<span class="constant">Accelerate</span> downwards, apply collision detection <span class="keyword">when</span> the bottom of the
box hits the floor (height value of the canvas) to make the box rest on
the bottom

<span class="comment">###</span>

<span class="keyword">class</span> <span class="class">Box</span>

    canvas = null
    box = null

    constructor: (<span class="instance-variable">@canvas</span>) -&gt;
        
        <span class="instance-variable">@x</span> = <span class="constant">Math</span>.random() * canvas.width
        <span class="instance-variable">@y</span> = <span class="integer">0</span>
        <span class="instance-variable">@width</span> = <span class="integer">50</span>
        <span class="instance-variable">@height</span> = <span class="integer">50</span>
        <span class="instance-variable">@speed</span> = <span class="integer">1</span>
        <span class="instance-variable">@acceleration</span> = .<span class="error">98</span>
        <span class="instance-variable">@at_rest</span> = <span class="predefined-constant">false</span>

<span class="keyword">class</span> <span class="class">Stage</span> 

    c = ctx = box = null
    stopAnimation = <span class="predefined-constant">false</span>

    constructor: (canvas, context) -&gt;
        c = canvas
        ctx = context
        box = new Box(c)

        <span class="instance-variable">@draw</span>()

    draw: =&gt;

        ctx.clearRect <span class="integer">0</span>, <span class="integer">0</span>, c.width, c.height
        
        <span class="comment"># to smooth out the collission</span>
        <span class="keyword">if</span> (box.y + box.height) &lt;= (c.height - box.height)

            box.y += box.speed
            box.speed += box.acceleration
            ctx.strokeRect box.x, box.y, box.width, box.height
            foo = setTimeout <span class="instance-variable">@draw</span>, <span class="integer">60</span>
        <span class="keyword">else</span>
            ctx.strokeRect box.x, c.height - box.height, box.width, box.height
            <span class="comment">#clearTimeout foo</span>
        
        <span class="comment"># What happens to this box after it has fallen off the canvas? does it</span>
        <span class="comment"># still consume memory?</span>


<span class="error">$</span>(window).ready -&gt;
    canvas = <span class="error">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">#mycanvas</span><span class="delimiter">'</span></span>).get(<span class="integer">0</span>)
    context = canvas.getContext(<span class="string"><span class="delimiter">'</span><span class="content">2d</span><span class="delimiter">'</span></span>)
    stage = new Stage(canvas, context)</code></pre>
<p></p>
	  </div>
		<p/>



    <!-- Start of StatCounter Code for Default Guide -->
	
  <script type="text/javascript">
  var sc_project=7827488; 
  var sc_invisible=1; 
  var sc_security="069357c9"; 
  </script>
  <script type="text/javascript"
      src="http://www.statcounter.com/counter/counter.js"></script>
  <noscript><div class="statcounter"><a title="customizable
      counter" href="http://statcounter.com/free-hit-counter/"
      target="_blank"><img class="statcounter"
      src="http://c.statcounter.com/7827488/0/069357c9/1/"
      alt="customizable counter"></a></div></noscript>
  <!-- End of StatCounter Code for Default Guide -->
   
    
<!--
<p/></p><p/></p>
<strong>For discussions,</strong> please use <a href="https://groups.google.com/group/thelogbox">theLogBox Google Group</a>. Follow me on <a href="https://twitter.com/thelogbox">Twitter</a> or <a href="https://facebook.com/thelogbox.dev">Facebook.com/thelogbox.dev</a>

-->

<div id="mc_embed_signup">
<form action="http://thelogbox.us5.list-manage.com/subscribe/post?u=ccf5609c10396fa44241f5400&amp;id=0117706770" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
	
<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="To get our updates, enter your email here" required>
<div class="clear">  
  <input type="submit" value="Subscribe"
  name="subscribe" id="mc-embedded-subscribe"
  class="button">
</div>
</form>
</div>

    <footer>
      &copy 2009-2013 theLogBox.com 

    </foter>

    </div>
  </body>

</html>
